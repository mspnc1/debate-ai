**Title**
- BYOK Strategy, IAP Plan, and Demo Mode (Debate, Round‑Robin Chat, Compare)

**Purpose**
- Define a safe, review‑ready path to ship: BYOK‑only generation, Premium via IAP for first‑party features, and a truthful Demo Mode that incurs no variable API costs.

**Summary**
- Core: App requires user API keys (BYOK) for any new AI generation.
- Premium: Sells our first‑party capabilities (orchestration, templates, analytics, sync, exports) via IAP. We do not sell tokens or third‑party access.
- Demo Mode: Bundled, clearly labeled recorded examples for Debate, Round‑Robin Chat, and Compare; zero live calls; brand‑safe copy.

**App Review Positioning**
- The app is functional on first launch without external accounts: users can explore recorded examples, navigate rounds, view rubrics, and export results.
- Connecting an API key is optional and only required to generate new content.
- Premium unlocks our features only (not model access/usage). Keys are stored locally.
- Demo assets are “Recorded examples,” not live provider calls, and are labeled as such.

**Scope**
- In‑scope: BYOK only, local key storage; Premium via IAP (non‑consumable to start); Demo Mode content and UI; brand‑safe copy; minimal telemetry (opt‑in).
- Out‑of‑scope (for this milestone): Hosting our own API keys; server‑side proxy; paid usage of third‑party APIs.

**Premium Offering (IAP) — First‑Party Features Only**
- Orchestration tools: custom debate formats, turn timers, round templates, judge rubrics.
- Content workflow: folders/projects/tags, search, saved presets, bulk exports (Markdown/PDF).
- Coaching/analytics: scoring guides, progress dashboards, topic coverage heatmaps.
- Sync/backup: cross‑device sync for app data (if/when added; can be deferred to v2).
- Team sharing (future): share templates/presets; no third‑party usage is sold.

**What Premium Is Not**
- Not “more tokens,” “cheaper usage,” or “unlock GPT‑4/Claude.”
- Not resale or proxying of third‑party APIs.

**BYOK Policy**
- Required for new generation.
- Stored locally only (Keychain/Keystore); never synced by default; never logged.
- Validate on save with a quick metadata call when possible (with strict timeout). If validation is unavailable, apply format checks and defer to first failure.
- UX: Provider setup wizard with deep links to provider key pages and copy‑pattern detection.

**Demo Mode — Principles**
- Truthful: “Recorded example — no live AI call.”
- Brand‑safe: No provider logos. Provider names appear only in a details pane if the sample was truly generated by that provider; otherwise keep samples unbranded.
- Offline: Assets bundled with the app under `src/assets/` or `assets/`.
- Usable: Full navigation (rounds, turns), rubric display, highlights, exports.

**Demo Content Types**
- Debate (two AIs, turn‑based): Opening → Rebuttal → Cross‑ex → Closing; rubric + scores.
- Round‑Robin Chat (≥3 agents): Sequential responses per round across agents A/B/C.
- Compare (side‑by‑side outputs): Same prompt, two outputs, rubric/criteria and notes.

**Demo Asset Schema (JSON)**
- Debate (example):
  ```json
  {
    "type": "debate",
    "id": "sample-debate-01",
    "title": "Should universal basic income be implemented?",
    "format": {
      "name": "Parliamentary",
      "rounds": ["Opening", "Rebuttal", "CrossEx", "Closing"]
    },
    "recorded": {
      "at": "2025-03-04T12:00:00Z",
      "source": "Recorded example",
      "models": [
        { "label": "AI A", "modelName": "gpt-4o", "provider": "OpenAI" },
        { "label": "AI B", "modelName": "Claude 3.5 Sonnet", "provider": "Anthropic" }
      ],
      "disclaimer": "Recorded example — not a live AI call"
    },
    "turns": [
      {
        "round": "Opening",
        "speaker": "AI A",
        "content": "...",
        "tokens_in": 512,
        "tokens_out": 320
      },
      {
        "round": "Opening",
        "speaker": "AI B",
        "content": "..."
      }
    ],
    "rubric": {
      "criteria": [
        { "id": "logic", "label": "Logical structure", "weight": 0.4 },
        { "id": "evidence", "label": "Evidence & citations", "weight": 0.3 },
        { "id": "rhetoric", "label": "Clarity & rhetoric", "weight": 0.3 }
      ],
      "scores": [
        { "speaker": "AI A", "logic": 4, "evidence": 3, "rhetoric": 5 },
        { "speaker": "AI B", "logic": 5, "evidence": 4, "rhetoric": 4 }
      ],
      "notes": "Edited for brevity"
    }
  }
  ```
- Round‑Robin Chat (example):
  ```json
  {
    "type": "round_robin",
    "id": "sample-rr-01",
    "title": "Designing a study plan",
    "agents": ["Planner", "Skeptic", "Synthesizer"],
    "recorded": { "at": "2025-03-04T12:00:00Z", "source": "Recorded example" },
    "rounds": [
      {
        "index": 1,
        "messages": [
          { "agent": "Planner", "content": "..." },
          { "agent": "Skeptic", "content": "..." },
          { "agent": "Synthesizer", "content": "..." }
        ]
      }
    ]
  }
  ```
- Compare (example):
  ```json
  {
    "type": "compare",
    "id": "sample-compare-01",
    "title": "Explain backpropagation to a 10‑year‑old",
    "prompt": "Explain backpropagation for neural nets simply.",
    "recorded": { "at": "2025-03-04T12:00:00Z", "source": "Recorded example" },
    "outputs": [
      { "label": "Output A", "content": "..." },
      { "label": "Output B", "content": "..." }
    ],
    "criteria": ["Clarity", "Accuracy", "Engagement"],
    "notes": "Edited for brevity"
  }
  ```

**Demo UX Copy (Brand‑Safe)**
- Banner: "Recorded example — no live AI call"
- Detail panel: "Recorded on <date>. Some samples may be edited for brevity. Providers shown reflect the original generation and do not indicate endorsement."
- Empty state CTA: "Connect your AI provider to generate new debates and analyses."

**IAP Plan**
- Product strategy: Start with a single non‑consumable "Premium" unlock to avoid server‑side subscription validation complexity. Consider upgrading to subscription when sync/cloud features ship.
- Suggested identifiers:
  - iOS `com.yourcompany.symposium.premium`
  - Android `premium`
- Pricing: Tiered by store guidance; pick the lowest tier that reflects value (e.g., US $14.99–$24.99 one‑time). If/when subscription: monthly/annual with intro offer.
- Entitlement model: One boolean entitlement `premium=true` unlocks first‑party features only. Generation remains BYOK regardless of entitlement.

**IAP Implementation Notes (Expo/React Native)**
- Libraries: choose one path and stick to it per platform.
  - Option A (single‑vendor abstraction): RevenueCat `purchases-react-native` — fastest to ship, handles receipt validation and restores across devices. Requires third‑party account/service.
  - Option B (direct): `react-native-iap` — no third‑party; you manage product fetching, purchase flow, receipt storage, restore, and edge cases. For non‑consumable, this is manageable.
- Minimal direct path (Option B):
  - Initialize IAP on app start; fetch products; expose `purchasePremium()` and `restorePurchases()`.
  - On purchase success, persist entitlement locally (secured storage) and trigger UI updates.
  - Implement restore on settings screen; entitlement toggles to `true` if purchase is found.
  - Receipt validation: optional for non‑consumable at v1; rely on store "restore" and user’s Apple/Google account. Add server validation later if needed.

**Gating Logic (Client)**
- `premium=true` unlocks: custom formats/rubrics, projects/folders/tags, bulk export, analytics dashboards, (future) sync.
- BYOK gating (independent of premium): new generation (Debate, Round‑Robin, Compare) requires at least one valid provider key locally.
- Demo content always accessible.

**UI Surface Changes (Indicative)**
- Settings > AI Providers: Add BYOK wizard (validate on save, keychain/keystore storage, copy pattern checks, provider docs links).
- Library > Samples: List of recorded examples (Debate, Round‑Robin, Compare) with the "Recorded example" badge.
- Paywall: Emphasize orchestration, analysis, and workflow features; avoid model/token language.
- Empty states on generation screens: Friendly prompt to connect a key; quick link to provider wizard.

**Privacy & Compliance**
- Keys: Local only; never uploaded; allow optional key purge; redact keys from bug reports.
- Demo: Clearly labeled as recorded; avoid provider logos; provider names only in details if accurate.
- Analytics: Opt‑in; aggregate only; no prompts/outputs without consent.
- App privacy labels: Reflect local key storage and optional analytics.

**App Store Review Notes (Use in App Store Connect)**
- "The app is fully usable on first launch with recorded examples that demonstrate the debate and analysis features. Connecting an AI API key is optional and only required to generate new content. We do not sell access to third‑party services; Premium (IAP) unlocks first‑party features such as custom formats, analytics, and exports. API keys are stored locally on device only. Demo content is clearly labeled as recorded and not a live AI call."

**Milestones & Checklist**
- M1: IAP groundwork (non‑consumable Premium)
  - Create products in App Store Connect and Google Play Console.
  - Implement product fetch, purchase, and restore flows.
  - Persist entitlement and add `premium` gating in UI.
- M2: BYOK wizard
  - Provider pages deep links, key format hints, local validation, secure storage.
  - Clear delete/purge controls.
- M3: Demo Mode (Debate, Round‑Robin, Compare)
  - Author 5–10 recorded examples; convert to JSON schema above; place under `src/assets/samples/`.
  - Build sample browsers and playback UIs.
  - Add "Recorded example" badges and details panel.
- M4: Paywall and copy
  - Premium screen; feature matrix; brand‑safe wording.
  - Empty state prompts linking to BYOK.
- M5: Review & release
  - App Privacy labels; Review Notes; screenshots include sample playback.
  - Internal testing on TestFlight/Play testing with purchase/restore flows.

**Open Questions**
- Will we add cross‑device sync in v1? If yes, consider subscription earlier and/or a lightweight backend.
- Do we want RevenueCat abstraction now for faster receipts handling?
- How many samples to bundle to balance app size vs. usefulness?

**Developer Tasks (Where to implement)**
- `src/services/iap/`: IAP abstraction (`init`, `getProducts`, `purchasePremium`, `restore`), platform guards.
- `src/store/entitlements/`: minimal state for `premium` flag, persisted.
- `src/services/keys/`: secure local storage for provider keys, basic validators.
- `src/screens/Settings/ProvidersScreen.tsx`: BYOK wizard UI.
- `src/screens/Purchase/Upgrade.tsx`: Paywall + purchase/restore buttons.
- `src/screens/Samples/`: browsers for Debate, Round‑Robin, Compare.
- `src/services/samples/`: loader/parsers for the JSON schemas above.
- `src/constants/featureFlags.ts`: centralize gates for `premium` and `hasKeys`.

**QA Plan (Smoke)**
- Fresh install: no keys, no premium → Samples playable, cannot generate; paywall reachable.
- Purchase flow: buy premium → gated features unlock; generation still requires keys.
- Restore: reinstall → restore purchases restores premium; samples still playable.
- Keys: add/remove/invalid key → wizard feedback and correct gating.

**Notes on Content Creation**
- Generate samples offline using your provider accounts; store the raw transcripts, then lightly edit for brevity if needed and mark as such. Keep a private log of which model produced what for internal reference.

